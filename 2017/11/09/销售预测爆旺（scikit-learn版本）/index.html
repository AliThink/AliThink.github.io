<!DOCTYPE html>
<html lang=zh>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="悼念一下回归模型的悲剧，先尝试一下分类模型，稍后再整他  1 数据探索 sparkSQL支持用sql对数据集进行分析，数据探索工作仍然大部分放在spark中来完成  1.1 🔑发现的一些相关性 对应的数值越接近1表示正相关性越大，越接近-1表示负相关性越大，越接近0表示相关性越小   销售额的相关度往往好于销量 毛利率、销量以及库存周转率的权衡在销售额上综合体现了？ 销售任务的导向作用?">
<meta property="og:type" content="article">
<meta property="og:title" content="销售预测爆旺（scikit-learn版本）">
<meta property="og:url" content="/2017/11/09/销售预测爆旺（scikit-learn版本）/index.html">
<meta property="og:site_name" content="The  Force  Awakens
">
<meta property="og:description" content="悼念一下回归模型的悲剧，先尝试一下分类模型，稍后再整他  1 数据探索 sparkSQL支持用sql对数据集进行分析，数据探索工作仍然大部分放在spark中来完成  1.1 🔑发现的一些相关性 对应的数值越接近1表示正相关性越大，越接近-1表示负相关性越大，越接近0表示相关性越小   销售额的相关度往往好于销量 毛利率、销量以及库存周转率的权衡在销售额上综合体现了？ 销售任务的导向作用?">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://i.loli.net/2018/12/21/5c1cabba1faf7.jpg">
<meta property="og:image" content="https://i.loli.net/2018/12/21/5c1caba091d02.jpg">
<meta property="og:image" content="https://i.loli.net/2018/12/21/5c1caba09e791.jpg">
<meta property="og:image" content="https://i.loli.net/2018/12/21/5c1cabba244a6.jpg">
<meta property="og:image" content="https://i.loli.net/2018/12/21/5c1cabba9e6d8.jpg">
<meta property="og:image" content="https://i.loli.net/2018/12/21/5c1cabbaa02df.png">
<meta property="og:updated_time" content="2018-12-21T09:12:11.134Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="销售预测爆旺（scikit-learn版本）">
<meta name="twitter:description" content="悼念一下回归模型的悲剧，先尝试一下分类模型，稍后再整他  1 数据探索 sparkSQL支持用sql对数据集进行分析，数据探索工作仍然大部分放在spark中来完成  1.1 🔑发现的一些相关性 对应的数值越接近1表示正相关性越大，越接近-1表示负相关性越大，越接近0表示相关性越小   销售额的相关度往往好于销量 毛利率、销量以及库存周转率的权衡在销售额上综合体现了？ 销售任务的导向作用?">
<meta name="twitter:image" content="https://i.loli.net/2018/12/21/5c1cabba1faf7.jpg">
    
    
        
          
              <link rel="shortcut icon" href="/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/img/favicon.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/img/favicon.png">
          
        
    
    <!-- title -->
    <title>销售预测爆旺（scikit-learn版本）</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about">About</a></li>
         
          <li><a href="/archives">Writing</a></li>
         
          <li><a href="/categories">categories</a></li>
         
          <li><a href="https://github.com/AliThink">Projects</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2017/11/09/xgboost填坑/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2017/11/09/销售预测案例源码分析/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=/2017/11/09/销售预测爆旺（scikit-learn版本）/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=/2017/11/09/销售预测爆旺（scikit-learn版本）/&text=销售预测爆旺（scikit-learn版本）"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=/2017/11/09/销售预测爆旺（scikit-learn版本）/&title=销售预测爆旺（scikit-learn版本）"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=/2017/11/09/销售预测爆旺（scikit-learn版本）/&is_video=false&description=销售预测爆旺（scikit-learn版本）"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=销售预测爆旺（scikit-learn版本）&body=Check out this article: /2017/11/09/销售预测爆旺（scikit-learn版本）/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=/2017/11/09/销售预测爆旺（scikit-learn版本）/&title=销售预测爆旺（scikit-learn版本）"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=/2017/11/09/销售预测爆旺（scikit-learn版本）/&title=销售预测爆旺（scikit-learn版本）"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=/2017/11/09/销售预测爆旺（scikit-learn版本）/&title=销售预测爆旺（scikit-learn版本）"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=/2017/11/09/销售预测爆旺（scikit-learn版本）/&title=销售预测爆旺（scikit-learn版本）"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=/2017/11/09/销售预测爆旺（scikit-learn版本）/&name=销售预测爆旺（scikit-learn版本）&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-数据探索"><span class="toc-number">1.</span> <span class="toc-text">1 数据探索</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-🔑发现的一些相关性"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 🔑发现的一些相关性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-决定尝试分offset构建模型"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 决定尝试分offset构建模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-预测商品级销量分类段划分：offset-total-quantity"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.2.1 预测商品级销量分类段划分：offset_total_quantity</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-2-参考周期划分："><span class="toc-number">1.2.2.</span> <span class="toc-text">1.2.2 参考周期划分：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-开撸"><span class="toc-number">2.</span> <span class="toc-text">2 开撸</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-包引入"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 包引入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#核心包简介"><span class="toc-number">2.1.1.</span> <span class="toc-text">核心包简介</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-辅助函数声明"><span class="toc-number">3.</span> <span class="toc-text">2. 辅助函数声明</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-生成对应offset的类标"><span class="toc-number">3.1.</span> <span class="toc-text">2.1 生成对应offset的类标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-特征变换"><span class="toc-number">3.2.</span> <span class="toc-text">2.2 特征变换</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#方法"><span class="toc-number">3.2.1.</span> <span class="toc-text">方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-样本均匀化"><span class="toc-number">3.3.</span> <span class="toc-text">2.3 样本均匀化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#前情回顾"><span class="toc-number">3.3.1.</span> <span class="toc-text">前情回顾</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#under-sampling"><span class="toc-number">3.3.2.</span> <span class="toc-text">under-sampling</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#over-sampling"><span class="toc-number">3.3.3.</span> <span class="toc-text">over-sampling</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-模型算法"><span class="toc-number">3.4.</span> <span class="toc-text">2.4 模型算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#逻辑斯蒂回归"><span class="toc-number">3.4.1.</span> <span class="toc-text">逻辑斯蒂回归</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#随机森林"><span class="toc-number">3.4.2.</span> <span class="toc-text">随机森林</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SVM"><span class="toc-number">3.4.3.</span> <span class="toc-text">SVM</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GBDT"><span class="toc-number">3.4.4.</span> <span class="toc-text">GBDT</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#xgboost"><span class="toc-number">3.4.5.</span> <span class="toc-text">xgboost</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-预测类"><span class="toc-number">3.5.</span> <span class="toc-text">2.5 预测类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-数据准备"><span class="toc-number">4.</span> <span class="toc-text">3. 数据准备</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-数据读取"><span class="toc-number">4.1.</span> <span class="toc-text">3.1 数据读取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-销量特征log变换"><span class="toc-number">4.2.</span> <span class="toc-text">3.2 销量特征log变换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-类标生成"><span class="toc-number">4.3.</span> <span class="toc-text">3.3 类标生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-数据清洗"><span class="toc-number">4.4.</span> <span class="toc-text">3.4 数据清洗</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#结果"><span class="toc-number">5.</span> <span class="toc-text">结果</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#特征重要性分析"><span class="toc-number">5.1.</span> <span class="toc-text">特征重要性分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#综合对比"><span class="toc-number">5.2.</span> <span class="toc-text">综合对比</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考"><span class="toc-number">6.</span> <span class="toc-text">参考</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        销售预测爆旺（scikit-learn版本）
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
        <span itemprop="name">The  Force  Awakens
</span>
      </span>
      
    <div class="postdate">
        <time datetime="2017-11-09T14:43:52.000Z" itemprop="datePublished">2017-11-09</time>
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/ML/">ML</a>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <blockquote>
<p>悼念一下回归模型的悲剧，先尝试一下分类模型，稍后再整他</p>
</blockquote>
<h2 id="1-数据探索"><a href="#1-数据探索" class="headerlink" title="1 数据探索"></a>1 数据探索</h2><blockquote>
<p>sparkSQL支持用sql对数据集进行分析，数据探索工作仍然大部分放在spark中来完成</p>
</blockquote>
<h3 id="1-1-🔑发现的一些相关性"><a href="#1-1-🔑发现的一些相关性" class="headerlink" title="1.1 🔑发现的一些相关性"></a>1.1 🔑发现的一些相关性</h3><blockquote>
<p>对应的数值越接近1表示正相关性越大，越接近-1表示负相关性越大，越接近0表示相关性越小</p>
</blockquote>
<ul>
<li>销售额的相关度往往好于销量<ul>
<li>毛利率、销量以及库存周转率的权衡在销售额上综合体现了？</li>
<li>销售任务的导向作用?</li>
</ul>
</li>
<li><p>排除极low款与爆款的前提下</p>
<ul>
<li>新货前30天预测后30天相关性较大</li>
<li><p>新货前30天预测整个商品季相关性较大</p>
<ul>
<li>放开爆款，反而销量的相关度上去了</li>
<li>销售额的相关度有所下降</li>
</ul>
<ul>
<li><img src="https://i.loli.net/2018/12/21/5c1cabba1faf7.jpg" alt="15060597682343"></li>
<li><img src="https://i.loli.net/2018/12/21/5c1caba091d02.jpg" alt="15060602769621"></li>
<li><img src="https://i.loli.net/2018/12/21/5c1caba09e791.jpg" alt="15060632132189"></li>
</ul>
</li>
</ul>
</li>
<li>冬装数据太奇葩了，基本依托于两个大活动走货<ul>
<li>考虑要把冬装单独拆分出模型来搞</li>
<li>其它季节货品使用一个预测模型</li>
<li>只保留冬季的情况<br><img src="https://i.loli.net/2018/12/21/5c1cabba244a6.jpg" alt="15063072795952"></li>
</ul>
</li>
</ul>
<h3 id="1-2-决定尝试分offset构建模型"><a href="#1-2-决定尝试分offset构建模型" class="headerlink" title="1.2 决定尝试分offset构建模型"></a>1.2 决定尝试分offset构建模型</h3><h4 id="1-2-1-预测商品级销量分类段划分：offset-total-quantity"><a href="#1-2-1-预测商品级销量分类段划分：offset-total-quantity" class="headerlink" title="1.2.1 预测商品级销量分类段划分：offset_total_quantity"></a>1.2.1 预测商品级销量分类段划分：offset_total_quantity</h4><table>
<thead>
<tr>
<th>Offset（销量）</th>
<th>正分类（大于offset）</th>
<th>负分类(小于offset)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1000</td>
<td>1477</td>
<td>4471</td>
</tr>
<tr>
<td>1600</td>
<td>1016</td>
<td>4932</td>
</tr>
<tr>
<td>10000</td>
<td>204</td>
<td>5744</td>
</tr>
<tr>
<td>50000</td>
<td>16</td>
<td>5932</td>
</tr>
</tbody>
</table>
<h4 id="1-2-2-参考周期划分："><a href="#1-2-2-参考周期划分：" class="headerlink" title="1.2.2 参考周期划分："></a>1.2.2 参考周期划分：</h4><blockquote>
<p>重点调优放在前三个档，因为参考周期太长，预测的意义也就小了</p>
</blockquote>
<ul>
<li>前3天：offset3_quantity</li>
<li>前7天：offset7_quantity</li>
<li>前15天：offset15_quantity</li>
<li>前30天：offset30_quantity </li>
</ul>
<h2 id="2-开撸"><a href="#2-开撸" class="headerlink" title="2 开撸"></a>2 开撸</h2><blockquote>
<p>代码的注释基本都用的英文，不是为了装逼，是怕有字符集兼容问题。。。</p>
</blockquote>
<h3 id="2-1-包引入"><a href="#2-1-包引入" class="headerlink" title="2.1 包引入"></a>2.1 包引入</h3><blockquote>
<p>大致分为三类: 数据操作类、sklearn相关、可视化相关。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># package import</span></span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> log</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> DataFrame</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> Template</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> OneHotEncoder</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score,f1_score</span><br><span class="line"><span class="keyword">from</span> sklearn.externals <span class="keyword">import</span> joblib</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> plotly.offline <span class="keyword">import</span> download_plotlyjs, init_notebook_mode, plot, iplot</span><br><span class="line"><span class="keyword">import</span> plotly.plotly <span class="keyword">as</span> py</span><br><span class="line"><span class="keyword">import</span> plotly.graph_objs <span class="keyword">as</span> go</span><br></pre></td></tr></table></figure>
<h4 id="核心包简介"><a href="#核心包简介" class="headerlink" title="核心包简介"></a>核心包简介</h4><ul>
<li>pandas: 数据集读取操作查询转换输出库。</li>
<li>sklearn: scikit-learn提供的ML相关方法实现库。<ul>
<li>preprocessing: 特征预处理相关。</li>
<li>model_selection: model所需的数据集选取生成。</li>
<li>metrics: 模型效果评估相关方法。</li>
<li>externals: 模型持久化相关。</li>
</ul>
</li>
<li>plotly: 发现的一个第三方可视化库，比matplotlib操作起来简单，生成图形可以交互分享，但是间歇性被墙。。😂</li>
</ul>
<h2 id="2-辅助函数声明"><a href="#2-辅助函数声明" class="headerlink" title="2. 辅助函数声明"></a>2. 辅助函数声明</h2><h3 id="2-1-生成对应offset的类标"><a href="#2-1-生成对应offset的类标" class="headerlink" title="2.1 生成对应offset的类标"></a>2.1 生成对应offset的类标</h3><blockquote>
<p>类标生成辅助方法，方法会塞入到pandas dataframe的apply方法中，默认会传入row</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_hot_product_label</span><span class="params">(row, offset, column_index)</span>:</span></span><br><span class="line">    <span class="string">"""Classification label generator.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        row: pandas dataframe row.</span></span><br><span class="line"><span class="string">        offset: Classification offset, such as 1000, 1600, 10000, 50000.</span></span><br><span class="line"><span class="string">        column_index: Dataframe row[column_index], such as row[12].</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Return:</span></span><br><span class="line"><span class="string">        Result of row_column value above offset. For example:</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        1: row_column &gt;= offset.</span></span><br><span class="line"><span class="string">        0: row_column &lt; offset.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">if</span> (row[column_index] &gt;= offset):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>
<h3 id="2-2-特征变换"><a href="#2-2-特征变换" class="headerlink" title="2.2 特征变换"></a>2.2 特征变换</h3><blockquote>
<p>减少特征之间或者特征与类标之间取值差距，blablabla</p>
</blockquote>
<h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><blockquote>
<p>log辅助方法</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log_quantity</span><span class="params">(row, column_index)</span>:</span></span><br><span class="line">    <span class="string">"""Log the value."""</span></span><br><span class="line">    <span class="keyword">return</span> log(row[column_index])</span><br></pre></td></tr></table></figure>
<blockquote>
<p>标准化转换</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">standardScalerTransform</span><span class="params">(X_train, X_test)</span>:</span></span><br><span class="line">    <span class="string">"""StandardScaler transform."""</span></span><br><span class="line">    sc = StandardScaler()</span><br><span class="line">    sc.fit(X_train)</span><br><span class="line">    <span class="keyword">return</span> (sc.transform(X_train), sc.transform(X_test))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>min-Max转换</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> MinMaxScaler</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">minMaxTransform</span><span class="params">(X_train, X_test)</span>:</span></span><br><span class="line">    <span class="string">"""MinMaxScaler transform."""</span></span><br><span class="line">    sc = MinMaxScaler()</span><br><span class="line">    sc.fit(X_train)</span><br><span class="line">    <span class="keyword">return</span> (sc.transform(X_train), sc.transform(X_test))</span><br></pre></td></tr></table></figure>
<h3 id="2-3-样本均匀化"><a href="#2-3-样本均匀化" class="headerlink" title="2.3 样本均匀化"></a>2.3 样本均匀化</h3><h4 id="前情回顾"><a href="#前情回顾" class="headerlink" title="前情回顾"></a>前情回顾</h4><blockquote>
<p>正负样本分布不均匀，需要均匀化处理，使得正负样本数基本一致。<br>隆重介绍<strong>imblearn</strong>库，提供各种样本均匀化算法的实现。</p>
</blockquote>
<table>
<thead>
<tr>
<th>Offset（销量）</th>
<th>正分类（大于offset）</th>
<th>负分类(小于offset)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1000</td>
<td>1477</td>
<td>4471</td>
</tr>
<tr>
<td>1600</td>
<td>1016</td>
<td>4932</td>
</tr>
<tr>
<td>10000</td>
<td>204</td>
<td>5744</td>
</tr>
<tr>
<td>50000</td>
<td>16</td>
<td>5932</td>
</tr>
</tbody>
</table>
<h4 id="under-sampling"><a href="#under-sampling" class="headerlink" title="under-sampling"></a>under-sampling</h4><blockquote>
<p>把多的砍掉，正样本多就砍正样本，负样本多就砍负样本的，最后就一致了。<br>至于如何砍就有很多算法了，这里选用了NearMiss算法。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> imblearn.under_sampling <span class="keyword">import</span> NearMiss</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">under_samplingTransform</span><span class="params">(X, y)</span>:</span></span><br><span class="line">    <span class="string">"""Under-sampling NearMiss mode."""</span></span><br><span class="line">    <span class="keyword">return</span> NearMiss(random_state=<span class="number">0</span>, version=<span class="number">1</span>).fit_sample(X, y)</span><br></pre></td></tr></table></figure>
<h4 id="over-sampling"><a href="#over-sampling" class="headerlink" title="over-sampling"></a>over-sampling</h4><blockquote>
<p>哪种样本少了，就想办法造一些，最后就一致了。<br>至于如何造就有很多算法了，这里选用了SMOTE的SVM模式算法。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> imblearn.over_sampling <span class="keyword">import</span> SMOTE, ADASYN</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">over_samplingTransform</span><span class="params">(X, y)</span>:</span></span><br><span class="line">    <span class="string">"""Over-sampling SMOTE svm mode."""</span></span><br><span class="line">    <span class="keyword">return</span> SMOTE(kind=<span class="string">'svm'</span>).fit_sample(X, y)</span><br></pre></td></tr></table></figure>
<h3 id="2-4-模型算法"><a href="#2-4-模型算法" class="headerlink" title="2.4 模型算法"></a>2.4 模型算法</h3><blockquote>
<p>最简单的是感知器算法，因为不能解决线性不可分问题，就忽略掉了。。</p>
</blockquote>
<h4 id="逻辑斯蒂回归"><a href="#逻辑斯蒂回归" class="headerlink" title="逻辑斯蒂回归"></a>逻辑斯蒂回归</h4><blockquote>
<p>唬人的名字，说是回归，其实是分类算法。。<br>分类界用的很多。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">logisticRegModelGenerator</span><span class="params">(train_std, y_train)</span>:</span></span><br><span class="line">    <span class="string">"""LogisticRegression model generator."""</span></span><br><span class="line">    <span class="keyword">return</span> LogisticRegression(C=<span class="number">1000</span>, random_state=<span class="number">0</span>).fit(train_std, y_train)</span><br></pre></td></tr></table></figure>
<h4 id="随机森林"><a href="#随机森林" class="headerlink" title="随机森林"></a>随机森林</h4><blockquote>
<p>理论上说可以忽略样本分布不均匀的问题（因为属于决策树类的算法）。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">random_forest_classifier</span><span class="params">(train_x, train_y)</span>:</span>    </span><br><span class="line">    <span class="string">"""Random Forest model generator."""</span> </span><br><span class="line">    <span class="keyword">return</span> RandomForestClassifier(n_estimators=<span class="number">8</span>).fit(train_x, train_y)</span><br></pre></td></tr></table></figure>
<h4 id="SVM"><a href="#SVM" class="headerlink" title="SVM"></a>SVM</h4><blockquote>
<p>忽然概念名词超多的算法，什么超平面啥的。。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">svm_classifier</span><span class="params">(train_x, train_y)</span>:</span>    </span><br><span class="line">    <span class="string">"""SVM model generator."""</span></span><br><span class="line">    <span class="keyword">return</span> SVC(kernel=<span class="string">'rbf'</span>, probability=<span class="keyword">True</span>).fit(train_x, train_y)</span><br></pre></td></tr></table></figure>
<h4 id="GBDT"><a href="#GBDT" class="headerlink" title="GBDT"></a>GBDT</h4><blockquote>
<p>梯度提升算法（实测在这个场景综合效果较好😘）</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> GradientBoostingClassifier    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gradient_boosting_classifier</span><span class="params">(train_x, train_y)</span>:</span>    </span><br><span class="line">    <span class="string">"""GBDT model generator."""</span></span><br><span class="line">    <span class="keyword">return</span> GradientBoostingClassifier(n_estimators=<span class="number">200</span>).fit(train_x, train_y)</span><br></pre></td></tr></table></figure>
<h4 id="xgboost"><a href="#xgboost" class="headerlink" title="xgboost"></a>xgboost</h4><blockquote>
<p>在kaggle大赛中叱咤风云的神级算法，在这个场景实测效果不如GBDT<br>但xg有些好处，比如可以输出每轮学习时的精确度，以及输出目前输入特征的重要性分数，便于优化调参。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> xgboost <span class="keyword">import</span> XGBClassifier</span><br><span class="line"><span class="keyword">from</span> xgboost <span class="keyword">import</span> plot_importance</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xgboost_classifier</span><span class="params">(train_x, train_y)</span>:</span></span><br><span class="line">    <span class="string">"""xgboost model generator."""</span></span><br><span class="line">    model = XGBClassifier()</span><br><span class="line">    model.fit(train_x, train_y)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Feature importance.</span></span><br><span class="line">    <span class="comment"># plot_importance(model)</span></span><br><span class="line">    <span class="comment"># pyplot.show()</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> model</span><br></pre></td></tr></table></figure>
<h3 id="2-5-预测类"><a href="#2-5-预测类" class="headerlink" title="2.5 预测类"></a>2.5 预测类</h3><blockquote>
<p>SalesProphet（销售预言家）：预测辅助类<br>因为各种特征offset、类标、算法的组合，不封装一个类的话，将来会死的。。（已经死过一轮了，改一个东东要累死。。）<br>具体方法作用详见注释哈，总之就是传入参数，调用predit完事。<br>（吐槽python 断言竟然只能在继承于testcase的类中使用。。）</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SalesProphet</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">"""Sales prediction class.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        datasource: Sales prediction datasource relied on.</span></span><br><span class="line"><span class="string">        features_name: Feature names array.</span></span><br><span class="line"><span class="string">        label_name: Label names String.</span></span><br><span class="line"><span class="string">        model_type: Algorithm of model training.</span></span><br><span class="line"><span class="string">        X: Feature data.</span></span><br><span class="line"><span class="string">        y: Label data.</span></span><br><span class="line"><span class="string">        X_train: X train data.</span></span><br><span class="line"><span class="string">        X_test: X test data.</span></span><br><span class="line"><span class="string">        y_train: y train data.</span></span><br><span class="line"><span class="string">        y_test: y test data.</span></span><br><span class="line"><span class="string">        y_pred: y data predicted.</span></span><br><span class="line"><span class="string">        model: ML model fitted.</span></span><br><span class="line"><span class="string">        accuracy_score: Model accuracy score.</span></span><br><span class="line"><span class="string">        f1_score: Model f1 score.</span></span><br><span class="line"><span class="string">        train_score: Model score in train set.</span></span><br><span class="line"><span class="string">        test_score: Model score in test set.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, datasource, features_name, label_name, model_type=<span class="string">'logistic'</span>)</span>:</span></span><br><span class="line">        <span class="string">"""Inits SalesProphet with datasource, features_name, label_name, model_type(default is logistic)"""</span></span><br><span class="line">        self.datasource = datasource</span><br><span class="line">        self.features_name = features_name</span><br><span class="line">        self.label_name = label_name</span><br><span class="line">        self.model_type = model_type</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">feature_engineering</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Feature engineering about: X y generated, one-hot, sampling blabla..."""</span></span><br><span class="line">        <span class="comment"># assertIsNotNone(self.datasource, 'Guys, forget the datasource!!!')</span></span><br><span class="line">        <span class="comment"># assertNotEqual(len(self.features_name), 0, 'features is empty. WTF...')</span></span><br><span class="line">        <span class="comment"># assertNotEqual(len(self.label_name), 0, 'label is empty. WTF...')</span></span><br><span class="line">        </span><br><span class="line">        self.X = self.datasource[self.features_name].values</span><br><span class="line">        self.y = self.datasource[self.label_name]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># one-hot</span></span><br><span class="line">        ohe = OneHotEncoder(categorical_features = [<span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line">        self.X = ohe.fit_transform(self.X).toarray()</span><br><span class="line">        </span><br><span class="line">        self.X, self.y = over_samplingTransform(self.X, self.y)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">train_test_transform</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Trainset and testset splitor and standard transform."""</span></span><br><span class="line">        self.X_train, self.X_test, self.y_train, self.y_test = train_test_split(self.X, self.y, test_size=<span class="number">0.3</span>, random_state=<span class="number">0</span>)</span><br><span class="line">        self.X_train, self.X_test = standardScalerTransform(self.X_train, self.X_test)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">model_fitting</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Algorithm of model selector."""</span></span><br><span class="line">        model_alg_switcher = &#123;</span><br><span class="line">            <span class="string">'logistic'</span>: logisticRegModelGenerator,</span><br><span class="line">            <span class="string">'rf'</span>: random_forest_classifier,</span><br><span class="line">            <span class="string">'svm'</span>: svm_classifier,</span><br><span class="line">            <span class="string">'gdbt'</span>: gradient_boosting_classifier,</span><br><span class="line">            <span class="string">'xgboost'</span>: xgboost_classifier</span><br><span class="line">        &#125;</span><br><span class="line">        func = model_alg_switcher.get(self.model_type, logisticRegModelGenerator)</span><br><span class="line">        <span class="keyword">return</span> func(self.X_train, self.y_train)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">genPredictReport</span><span class="params">(self, printlog=False)</span>:</span></span><br><span class="line">        <span class="string">"""Model estimate report generation. Set printlog YES to pring log."""</span></span><br><span class="line">        self.accuracy_score = accuracy_score(self.y_test, self.y_pred)</span><br><span class="line">        self.f1_score = f1_score(self.y_test, self.y_pred, average=<span class="string">'binary'</span>)</span><br><span class="line">        self.train_score = self.model.score(self.X_train, self.y_train)</span><br><span class="line">        self.test_score = self.model.score(self.X_test, self.y_test)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> printlog:</span><br><span class="line">            print(<span class="string">'/--------------START-------------'</span>)</span><br><span class="line">            print(<span class="string">'|'</span>)</span><br><span class="line">            print(<span class="string">'| feature: %s'</span> % self.features_name)</span><br><span class="line">            print(<span class="string">'| label: %s'</span> % self.label_name)</span><br><span class="line">            print(<span class="string">'| model alg: %s'</span> % self.model_type)</span><br><span class="line">            print(<span class="string">'|'</span>)</span><br><span class="line">            print(<span class="string">'|----Estimate score------'</span>)</span><br><span class="line">            print(<span class="string">'|'</span>)</span><br><span class="line">            print(<span class="string">'| accuracy is: %.2f'</span> % self.accuracy_score)</span><br><span class="line">            print(<span class="string">'| f1_score is: %.2f'</span> % self.f1_score)</span><br><span class="line">            print(<span class="string">'|'</span>)</span><br><span class="line">            print(<span class="string">'|---Over-fitting check---'</span>)</span><br><span class="line">            print(<span class="string">'|'</span>)</span><br><span class="line">            print(<span class="string">'| train-set score: %.2f'</span> % self.train_score)</span><br><span class="line">            print(<span class="string">'| test-set score: %.2f'</span> % self.test_score)</span><br><span class="line">            print(<span class="string">'|'</span>)</span><br><span class="line">            print(<span class="string">'|---------------END--------------/\n'</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">public_genReportChart</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""y_test and y_pred chart generation."""</span></span><br><span class="line">        t = np.arange(len(self.y_pred))</span><br><span class="line">        <span class="comment"># Create traces</span></span><br><span class="line">        trace0 = go.Scatter(</span><br><span class="line">            x = t,</span><br><span class="line">            y = self.y_pred,</span><br><span class="line">            mode = <span class="string">'lines'</span>,</span><br><span class="line">            name = <span class="string">'predict'</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        trace1 = go.Scatter(</span><br><span class="line">            x = t,</span><br><span class="line">            y = self.y_test,</span><br><span class="line">            mode = <span class="string">'lines'</span>,</span><br><span class="line">            name = <span class="string">'real'</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        data = [trace0, trace1]</span><br><span class="line"></span><br><span class="line">        py.iplot(data, filename=<span class="string">'(%self.features_name)_(%self.labels_name)_(%self.model_type.model)'</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">public_saveModel</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Model persistence."""</span></span><br><span class="line">        joblib.dump(self.model, <span class="string">'%(self.features_name)_%(self.labels_name)_(%self.model_type.model)'</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Predict main method."""</span></span><br><span class="line">        self.feature_engineering()</span><br><span class="line">        self.train_test_transform()</span><br><span class="line">        </span><br><span class="line">        self.model = self.model_fitting()</span><br><span class="line">        self.y_pred = self.model.predict(self.X_test)</span><br><span class="line">        self.genPredictReport()</span><br></pre></td></tr></table></figure>
<h2 id="3-数据准备"><a href="#3-数据准备" class="headerlink" title="3. 数据准备"></a>3. 数据准备</h2><h3 id="3-1-数据读取"><a href="#3-1-数据读取" class="headerlink" title="3.1 数据读取"></a>3.1 数据读取</h3><blockquote>
<p>从spark 导出准备好的数据到csv文件，pandas读取该csv中的数据。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train_data = pd.read_csv(<span class="string">"data/product_2016_offset_group.csv"</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>获取前5条数据看看情况</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train_data.head()</span><br></pre></td></tr></table></figure>
<blockquote>
<p>describe 可以对df中各列的综合指标进行集中展示。<br>比如中位数、均值等等，方便进一步分析数据。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train_data.describe()</span><br></pre></td></tr></table></figure>
<h3 id="3-2-销量特征log变换"><a href="#3-2-销量特征log变换" class="headerlink" title="3.2 销量特征log变换"></a>3.2 销量特征log变换</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">train_data[<span class="string">'log_3_quantity'</span>] = train_data.apply(log_quantity, column_index=<span class="number">8</span>, axis=<span class="number">1</span>)</span><br><span class="line">train_data[<span class="string">'log_7_quantity'</span>] = train_data.apply(log_quantity, column_index=<span class="number">9</span>, axis=<span class="number">1</span>)</span><br><span class="line">train_data[<span class="string">'log_15_quantity'</span>] = train_data.apply(log_quantity, column_index=<span class="number">10</span>, axis=<span class="number">1</span>)</span><br><span class="line">train_data[<span class="string">'log_30_quantity'</span>] = train_data.apply(log_quantity, column_index=<span class="number">11</span>, axis=<span class="number">1</span>)</span><br><span class="line">train_data[<span class="string">'log_total_quantity'</span>] = train_data.apply(log_quantity, column_index=<span class="number">12</span>, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train_data.head()</span><br></pre></td></tr></table></figure>
<h3 id="3-3-类标生成"><a href="#3-3-类标生成" class="headerlink" title="3.3 类标生成"></a>3.3 类标生成</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">train_data[<span class="string">'hot_1000_product'</span>] = train_data.apply(gen_hot_product_label, args=(<span class="number">1000</span>, <span class="number">12</span>), axis=<span class="number">1</span>)</span><br><span class="line">train_data[<span class="string">'hot_1600_product'</span>] = train_data.apply(gen_hot_product_label, args=(<span class="number">1600</span>, <span class="number">12</span>), axis=<span class="number">1</span>)</span><br><span class="line">train_data[<span class="string">'hot_10000_product'</span>] = train_data.apply(gen_hot_product_label, args=(<span class="number">10000</span>, <span class="number">12</span>), axis=<span class="number">1</span>)</span><br><span class="line">train_data[<span class="string">'hot_50000_product'</span>] = train_data.apply(gen_hot_product_label, args=(<span class="number">50000</span>, <span class="number">12</span>), axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">train_data.head()</span><br><span class="line">train_data[train_data.hot_1000_product == <span class="number">1</span>].count()</span><br></pre></td></tr></table></figure>
<pre><code>product_code                  1477
category_id                   1477
season                        1477
offset3_amount_actual         1477
offset7_amount_actual         1477
offset15_amount_actual        1477
offset30_amount_actual        1477
offset_total_amount_actual    1477
offset3_quantity              1477
offset7_quantity              1477
offset15_quantity             1477
offset30_quantity             1477
offset_total_quantity         1477
log_3_quantity                1477
log_7_quantity                1477
log_15_quantity               1477
log_30_quantity               1477
log_total_quantity            1477
hot_1000_product              1477
hot_1600_product              1477
hot_10000_product             1477
hot_50000_product             1477
dtype: int64
</code></pre><h3 id="3-4-数据清洗"><a href="#3-4-数据清洗" class="headerlink" title="3.4 数据清洗"></a>3.4 数据清洗</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train_data_normal = train_data[train_data.offset30_quantity &lt;= train_data.offset_total_quantity]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train_data_normal[train_data_normal.offset_total_quantity &lt; <span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># drop null row</span></span><br><span class="line">print(train_data_normal.isnull().sum())</span><br><span class="line">train_data_valid = train_data_normal.dropna()</span><br></pre></td></tr></table></figure>
<pre><code>product_code                  0
category_id                   0
season                        0
offset3_amount_actual         0
offset7_amount_actual         0
offset15_amount_actual        0
offset30_amount_actual        0
offset_total_amount_actual    0
offset3_quantity              0
offset7_quantity              0
offset15_quantity             0
offset30_quantity             0
offset_total_quantity         0
log_3_quantity                0
log_7_quantity                0
log_15_quantity               0
log_30_quantity               0
log_total_quantity            0
hot_1000_product              0
hot_1600_product              0
hot_10000_product             0
hot_50000_product             0
dtype: int64
</code></pre><blockquote>
<ol>
<li>无序特征做onehot消除次序关系。</li>
<li>整理特征与类标。</li>
<li>循环生成预言家，让它预测，生成报告，然后把他丢到预言家数组里面（salesProphets）便于后面生成分析对比用的DataFrame。</li>
</ol>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># category_id, season onehot</span></span><br><span class="line">feature_disordered = [<span class="string">'category_id'</span>, <span class="string">'season'</span>]</span><br><span class="line"></span><br><span class="line">feature_cols_3 = feature_disordered + [<span class="string">'offset3_quantity'</span>]</span><br><span class="line">feature_cols_7 = feature_disordered + [<span class="string">'offset7_quantity'</span>]</span><br><span class="line">feature_cols_15 = feature_disordered + [<span class="string">'offset15_quantity'</span>]</span><br><span class="line">feature_cols_30 = feature_disordered + [<span class="string">'offset30_quantity'</span>]</span><br><span class="line">feature_offsets = [feature_cols_3, feature_cols_7, feature_cols_15, feature_cols_30]</span><br><span class="line"></span><br><span class="line">label_names = [<span class="string">'hot_1000_product'</span>, <span class="string">'hot_1600_product'</span>, <span class="string">'hot_10000_product'</span>, <span class="string">'hot_50000_product'</span>]</span><br><span class="line"></span><br><span class="line">algs = [<span class="string">'logistic'</span>, <span class="string">'rf'</span>, <span class="string">'svm'</span>, <span class="string">'gdbt'</span>,<span class="string">'xgboost'</span>]</span><br><span class="line"></span><br><span class="line">salesProphets = []</span><br><span class="line"><span class="keyword">for</span> alg <span class="keyword">in</span> algs:</span><br><span class="line">    <span class="keyword">for</span> feature <span class="keyword">in</span> feature_offsets:</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> label_names:</span><br><span class="line">            salesProphet = SalesProphet(train_data_valid, feature, y, alg)</span><br><span class="line">            salesProphet.predict()</span><br><span class="line">            salesProphet.genPredictReport()</span><br><span class="line">            salesProphets.append(salesProphet)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>预言家数组生成综合对比DataFrame</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 整理生成报告DataFrame</span></span><br><span class="line">feature_column = []</span><br><span class="line">label_column = []</span><br><span class="line">model_alg_column = []</span><br><span class="line">accuracy_column = []</span><br><span class="line">f1_score_column = []</span><br><span class="line">trainset_score_column = []</span><br><span class="line">testset_score_column = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> salesProphet <span class="keyword">in</span> salesProphets:</span><br><span class="line">    feature_column.append(salesProphet.features_name)</span><br><span class="line">    label_column.append(salesProphet.label_name)</span><br><span class="line">    model_alg_column.append(salesProphet.model_type)</span><br><span class="line">    accuracy_column.append(salesProphet.accuracy_score)</span><br><span class="line">    f1_score_column.append(salesProphet.f1_score)</span><br><span class="line">    trainset_score_column.append(salesProphet.train_score)</span><br><span class="line">    testset_score_column.append(salesProphet.test_score)</span><br><span class="line"></span><br><span class="line">result_data = &#123;<span class="string">'feature'</span>: feature_column, <span class="string">'label'</span>: label_column, </span><br><span class="line">               <span class="string">'model_alg'</span>: model_alg_column, <span class="string">'accuracy'</span>: accuracy_column, </span><br><span class="line">               <span class="string">'f1_score'</span>: f1_score_column, <span class="string">'trainset_score'</span>: trainset_score_column, </span><br><span class="line">               <span class="string">'testset_score'</span>: testset_score_column&#125;</span><br><span class="line"></span><br><span class="line">result_df = DataFrame(result_data)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>分析报告保存</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result_df.to_csv(<span class="string">'data/result_df.csv'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><h3 id="特征重要性分析"><a href="#特征重要性分析" class="headerlink" title="特征重要性分析"></a>特征重要性分析</h3><blockquote>
<p>分数越高越重要</p>
</blockquote>
<p><img src="https://i.loli.net/2018/12/21/5c1cabba9e6d8.jpg" alt="模型特征重要性分析"></p>
<h3 id="综合对比"><a href="#综合对比" class="headerlink" title="综合对比"></a>综合对比</h3><blockquote>
<p>分数越接近1越好</p>
</blockquote>
<p><img src="https://i.loli.net/2018/12/21/5c1cabbaa02df.png" alt="综合对比报告"></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="http://scikit-learn.org/stable/" target="_blank" rel="noopener">scikit-learn官网</a></li>
<li><a href="http://contrib.scikit-learn.org/imbalanced-learn/stable/" target="_blank" rel="noopener">imbalanced-learn官网</a></li>
<li><a href="http://blog.csdn.net/Bryan__/article/details/51288953" target="_blank" rel="noopener">python sklearn分类算法简单调用</a></li>
<li><a href="http://www.jianshu.com/p/7e0e2d66b3d4" target="_blank" rel="noopener">Kaggle神器xgboost</a></li>
<li><a href="https://morvanzhou.github.io/tutorials/machine-learning/ML-intro/" target="_blank" rel="noopener">莫烦PYTHON 机器学习专题(需翻墙)</a></li>
</ul>

  </div>
</article>

    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
    <!--<script src="//cdn.jsdelivr.net/npm/leancloud-storage@latest/dist/av-min.js"></script>
    <script src='//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js'></script>-->
    <div class="blog-post-comments">
        <div id="vcomments"></div>
        <script>
          var notify = false == true ? true : false;
          var verify = false == true ? true : false;
          var visitor = true == true ? true : false;
          new Valine({
            el: '#vcomments',
              notify: notify,
              verify: verify,
            app_id: 'UDE2tWFJX1om8cC7yKjgWA9r-gzGzoHsz',
            app_key: 'iugcsrMhVBXsIqhhhWHAdgr1',
            lang: 'en',
            placeholder: 'ヾﾉ≧∀≦)o快来评论一下吧!',
            avatar: 'monsterid',
            pageSize: 10,
            visitor: visitor
          });
          </script>
      </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about">About</a></li>
         
          <li><a href="/archives">Writing</a></li>
         
          <li><a href="/categories">categories</a></li>
         
          <li><a href="https://github.com/AliThink">Projects</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-数据探索"><span class="toc-number">1.</span> <span class="toc-text">1 数据探索</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-🔑发现的一些相关性"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 🔑发现的一些相关性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-决定尝试分offset构建模型"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 决定尝试分offset构建模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-预测商品级销量分类段划分：offset-total-quantity"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.2.1 预测商品级销量分类段划分：offset_total_quantity</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-2-参考周期划分："><span class="toc-number">1.2.2.</span> <span class="toc-text">1.2.2 参考周期划分：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-开撸"><span class="toc-number">2.</span> <span class="toc-text">2 开撸</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-包引入"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 包引入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#核心包简介"><span class="toc-number">2.1.1.</span> <span class="toc-text">核心包简介</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-辅助函数声明"><span class="toc-number">3.</span> <span class="toc-text">2. 辅助函数声明</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-生成对应offset的类标"><span class="toc-number">3.1.</span> <span class="toc-text">2.1 生成对应offset的类标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-特征变换"><span class="toc-number">3.2.</span> <span class="toc-text">2.2 特征变换</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#方法"><span class="toc-number">3.2.1.</span> <span class="toc-text">方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-样本均匀化"><span class="toc-number">3.3.</span> <span class="toc-text">2.3 样本均匀化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#前情回顾"><span class="toc-number">3.3.1.</span> <span class="toc-text">前情回顾</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#under-sampling"><span class="toc-number">3.3.2.</span> <span class="toc-text">under-sampling</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#over-sampling"><span class="toc-number">3.3.3.</span> <span class="toc-text">over-sampling</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-模型算法"><span class="toc-number">3.4.</span> <span class="toc-text">2.4 模型算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#逻辑斯蒂回归"><span class="toc-number">3.4.1.</span> <span class="toc-text">逻辑斯蒂回归</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#随机森林"><span class="toc-number">3.4.2.</span> <span class="toc-text">随机森林</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SVM"><span class="toc-number">3.4.3.</span> <span class="toc-text">SVM</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GBDT"><span class="toc-number">3.4.4.</span> <span class="toc-text">GBDT</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#xgboost"><span class="toc-number">3.4.5.</span> <span class="toc-text">xgboost</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-预测类"><span class="toc-number">3.5.</span> <span class="toc-text">2.5 预测类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-数据准备"><span class="toc-number">4.</span> <span class="toc-text">3. 数据准备</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-数据读取"><span class="toc-number">4.1.</span> <span class="toc-text">3.1 数据读取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-销量特征log变换"><span class="toc-number">4.2.</span> <span class="toc-text">3.2 销量特征log变换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-类标生成"><span class="toc-number">4.3.</span> <span class="toc-text">3.3 类标生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-数据清洗"><span class="toc-number">4.4.</span> <span class="toc-text">3.4 数据清洗</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#结果"><span class="toc-number">5.</span> <span class="toc-text">结果</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#特征重要性分析"><span class="toc-number">5.1.</span> <span class="toc-text">特征重要性分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#综合对比"><span class="toc-number">5.2.</span> <span class="toc-text">综合对比</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考"><span class="toc-number">6.</span> <span class="toc-text">参考</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=/2017/11/09/销售预测爆旺（scikit-learn版本）/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=/2017/11/09/销售预测爆旺（scikit-learn版本）/&text=销售预测爆旺（scikit-learn版本）"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=/2017/11/09/销售预测爆旺（scikit-learn版本）/&title=销售预测爆旺（scikit-learn版本）"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=/2017/11/09/销售预测爆旺（scikit-learn版本）/&is_video=false&description=销售预测爆旺（scikit-learn版本）"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=销售预测爆旺（scikit-learn版本）&body=Check out this article: /2017/11/09/销售预测爆旺（scikit-learn版本）/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=/2017/11/09/销售预测爆旺（scikit-learn版本）/&title=销售预测爆旺（scikit-learn版本）"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=/2017/11/09/销售预测爆旺（scikit-learn版本）/&title=销售预测爆旺（scikit-learn版本）"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=/2017/11/09/销售预测爆旺（scikit-learn版本）/&title=销售预测爆旺（scikit-learn版本）"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=/2017/11/09/销售预测爆旺（scikit-learn版本）/&title=销售预测爆旺（scikit-learn版本）"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=/2017/11/09/销售预测爆旺（scikit-learn版本）/&name=销售预测爆旺（scikit-learn版本）&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">  
    Copyright &copy; 2019 AliThink
  </div>
  <div class="footer-right">
    
    <div class="busuanzi-count">
      <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
      
        <span class="site-uv">
          <i class="fa fa-child"></i> uv total
          <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
          
        </span>
      
      
      
        <span class="site-pv">
          <i class="fa fa-eye"></i> pv total
          <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
          
        </span>
      
    </div>


  </div>
  
</footer>


    </div>
</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?ddd5ea8fb6af25af228cf11a240076e8";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

<!-- Disqus Comments -->


